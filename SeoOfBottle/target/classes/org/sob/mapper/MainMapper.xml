<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="org.sob.mapper.MainMapper">
  <!-- 기본기능 -->
	  <select id="getList" resultType="org.sob.domain.MainVO"><!-- 내가 포함된 유리병 목록 불러오기 -->	
	  <![CDATA[select * from (select * from bottlemain natural join category where `to` = #{cno} or `from` = #{cno}) a where groupid in (select groupid from bottlemain where `to` = #{cno} or `from` = #{cno}) group by a.groupid order by letterid desc]]><!-- id부분 변경해야함. -->	
	  </select>
	  
	  <insert id="insert"><!-- 새글 등록 -->
	  	insert into bottlemain (`from`, `to`, cnt, `groupId`, `contents`,`categoryId`, `boast`) values(#{from}, #{to},#{cnt},#{groupId},#{contents},#{categoryId},#{boast})
	  </insert>
	  
	  <select id="read" resultType="org.sob.domain.MainVO"><!-- 내가 받은 편지 상세보기 -->
	  	select * from bottlemain natural join category where groupId = #{groupId} order by cnt
	  </select>
	  
	  <delete id="delete">
	  	delete from bottlemain where groupId = #{groupId }
	  
	  </delete>
	   <!-- 카테고리관련. -->
	  <select id="getCategoryList" resultType="org.sob.domain.MainVO"><!-- 내가 포함된 유리병 목록 불러오기 -->	
	  select * from category
	  </select>
	  
	  <!-- 리플관련. -->
	  <insert id="boastInsert"><!-- 새글 등록 -->
	  	insert into boast (`groupid`) values(#{groupid})
	  </insert>
	  
	  
  <!-- 자랑게시판 기능 쿼리짜야함. -->	
	  <select id="getBoastList" resultType="org.sob.domain.MainVO"><!-- 내가 포함된 유리병 목록 불러오기 -->	
	  <![CDATA[select * from bottlemain where `to` = #{cno} or `from` = #{cno} group by groupId order by #{letterId};]]><!-- id부분 변경해야함. -->	
	  </select>
  
  
  
    
	  
	  
	  
  </mapper>